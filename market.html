<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Admin Dashboard - Barangay Market Map</title>

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
:root {
  --text:#111;
  --blue:#0a53c1;
  --white:#fff;
  --border:#e6e8eb;
}

body{margin:0;font-family:Inter,system-ui,sans-serif;background:#fff;color:#111}

/* LAYOUT */
.app{display:grid;grid-template-columns:240px 1fr;height:100vh}
.sidebar{background:#4e73df;color:white}
.brand{padding:1rem;font-weight:bold;border-bottom:1px solid rgba(255,255,255,.2)}
nav{padding:1rem}
.nav-item{display:block;color:white;text-decoration:none;padding:.6rem;border-radius:6px;margin-bottom:5px}
.nav-item:hover,.nav-item.active{background:white;color:#4e73df}

.main{display:grid;grid-template-rows:60px 1fr}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:0 1rem;border-bottom:1px solid var(--border)}
.content{padding:1rem;overflow:hidden}

h1{color:var(--blue);margin-bottom:10px}

/* MAP */
#marketMap{
  height:70vh;
  border-radius:12px;
  border:2px solid var(--blue);
}

/* INFO PANEL */
.info-panel{
  margin-top:12px;
  padding:12px;
  border:1px solid var(--border);
  border-radius:10px;
  background:#f4f6f8;
}

/* LEGEND */
.legend{
  background:white;
  padding:10px;
  border-radius:10px;
  font-size:13px;
  box-shadow:0 4px 12px rgba(0,0,0,.1);
}
.legend div{margin-bottom:5px}
.box{
  width:14px;height:14px;display:inline-block;margin-right:6px;border-radius:3px
}
</style>
</head>
<body>

<div class="app">
  <!-- SIDEBAR (UNCHANGED) -->
  <aside class="sidebar">
    <div class="brand">LGU 3 ADMIN SYSTEM</div>
    <nav>
      <a href="#" class="nav-item active">Dashboard</a>
      <a href="#" class="nav-item">Vendor Management</a>
      <a href="#" class="nav-item">Commodity & Price Monitoring</a>
      <a href="#" class="nav-item">Inspection & Compliance</a>
      <a href="#" class="nav-item">Reports & AI Analytics</a>
      <a href="#" class="nav-item">Settings</a>
      <a href="#" class="nav-item" style="margin-top:2rem;font-weight:bold;">Logout</a>
    </nav>
  </aside>

  <!-- MAIN -->
  <section class="main">
    <header class="topbar">
      <button>‚Üê Back</button>
      <button>Export</button>
    </header>

    <div class="content">
      <h1>Barangay Public Market Map</h1>

      <div id="marketMap"></div>

      <div class="info-panel" id="stallInfo">
        Click a stall to view vendor information.
      </div>
    </div>
  </section>
</div>

<script>

/* =============================
   MAP SETUP
============================= */

const mapWidth = 1600;
const mapHeight = 1000;

const map = L.map('marketMap',{
  crs:L.CRS.Simple,
  minZoom:-2,
  maxZoom:3,
  zoomControl:true
});

const bounds = [[0,0],[mapHeight,mapWidth]];
map.fitBounds(bounds);


/* =============================
   MARKET LAYOUT (REAL ZONES)
============================= */

// WET SECTION BACKGROUND
const wetZone = L.rectangle([[50,100],[400,1500]],{
  color:"#1d3557",
  weight:2,
  fillColor:"#d0e7ff",
  fillOpacity:0.6
}).addTo(map);

// DRY SECTION BACKGROUND
const dryZone = L.rectangle([[450,100],[950,1500]],{
  color:"#2a9d8f",
  weight:2,
  fillColor:"#e9f7ef",
  fillOpacity:0.6
}).addTo(map);

// Labels
L.marker([80,120],{
  icon: L.divIcon({
    className:'',
    html:'<h3 style="color:#1d3557;">WET SECTION</h3>',
    iconSize:[200,40]
  })
}).addTo(map);

L.marker([480,120],{
  icon: L.divIcon({
    className:'',
    html:'<h3 style="color:#2a9d8f;">DRY SECTION</h3>',
    iconSize:[200,40]
  })
}).addTo(map);


/* =============================
   VENDOR DATA
============================= */

const vendors = {
  5:{name:"Pedro Fish Vendor",section:"Fish",status:"Occupied"},
  15:{name:"Violation Fish Stall",section:"Fish",status:"Violation"},
  18:{name:"Maria Meat Shop",section:"Meat",status:"Occupied"},
  60:{name:"ABC Grocery",section:"Grocery",status:"Occupied"},
  77:{name:"Dry Goods Store",section:"Dry Goods",status:"Occupied"},
  90:{name:"Textile Reserved",section:"Textile",status:"Reserved"},
  120:{name:"Carinderia ni Aling Nena",section:"Carinderia",status:"Occupied"}
};

/* =============================
   STATUS COLORS
============================= */

function getColor(status){
  if(status==="Occupied") return "#0a53c1";
  if(status==="Violation") return "#e63946";
  if(status==="Reserved") return "#ffb703";
  return "#adb5bd";
}

/* =============================
   CREATE STALL BLOCK (REAL SHAPE)
============================= */

function addStall(no,x,y,section){

  const vendor = vendors[no];
  const status = vendor ? vendor.status : "Vacant";

  const stall = L.rectangle([
    [y, x],
    [y+25, x+25]
  ],{
    color:getColor(status),
    weight:2,
    fillColor:getColor(status),
    fillOpacity:0.8
  }).addTo(map);

  stall.on("click",()=>{
    document.getElementById("stallInfo").innerHTML = `
      <strong>Stall No:</strong> ${no}<br>
      <strong>Section:</strong> ${section}<br>
      <strong>Status:</strong> ${status}<br>
      <strong>Vendor:</strong> ${vendor ? vendor.name : "Vacant"}
    `;
  });
}


/* =============================
   WET SECTION LAYOUT
============================= */

// Fish Row
for(let i=1;i<=20;i++){
  addStall(i, 200 + (i*40), 150, "Fish");
}

// Meat Row
for(let i=21;i<=40;i++){
  addStall(i, 200 + ((i-20)*40), 250, "Meat");
}


/* =============================
   DRY SECTION LAYOUT
============================= */

// Dry Goods
for(let i=41;i<=60;i++){
  addStall(i, 200 + ((i-40)*40), 550, "Dry Goods");
}

// Grocery
for(let i=61;i<=80;i++){
  addStall(i, 200 + ((i-60)*40), 650, "Grocery");
}

// Textile
for(let i=81;i<=110;i++){
  addStall(i, 200 + ((i-80)*30), 750, "Textile");
}

// Carinderia
for(let i=111;i<=130;i++){
  addStall(i, 200 + ((i-110)*40), 850, "Carinderia");
}


/* =============================
   LEGEND
============================= */

const legend = L.control({position:"bottomright"});
legend.onAdd=function(){
  const div=L.DomUtil.create("div","legend");
  div.innerHTML=`
  <div><b>Status</b></div>
  <div><span class="box" style="background:#0a53c1"></span>Occupied</div>
  <div><span class="box" style="background:#adb5bd"></span>Vacant</div>
  <div><span class="box" style="background:#e63946"></span>Violation</div>
  <div><span class="box" style="background:#ffb703"></span>Reserved</div>
  <hr>
  <div><b>Wet Section</b>: Fish, Meat</div>
  <div><b>Dry Section</b>: Grocery, Dry Goods, Textile, Carinderia</div>
  `;
  return div;
};
legend.addTo(map);

</script>


</body>
</html>

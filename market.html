<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Admin Dashboard - Barangay Market Map</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root {
  --text: #111111;
  --blue: #0a53c1;
  --ink-20: #f4f6f8;
  --white: #ffffff;
  --border: #e6e8eb;
  --shadow: 0 6px 24px rgba(0, 0, 0, .06);
}

* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: Inter, system-ui, sans-serif;
  background: var(--white);
  color: var(--text);
}

/* APP LAYOUT */
.app { display: grid; grid-template-columns: 240px 1fr; min-height: 100vh; }

.sidebar {
  border-right: 1px solid var(--border);
  background: #4e73df;
}
.brand {
  font-weight: 800;
  text-transform: uppercase;
  padding: 1rem;
  border-bottom: 1px solid var(--border);
  color: #fff;
}
nav { padding: 1rem; }
.nav-item {
  display: block; padding: .6rem;
  border-radius: 8px; text-decoration: none; color: var(--white);
  margin-bottom:5px;
}
.nav-item:hover, .nav-item.active { background: var(--ink-20); color: var(--blue); }

.main { display: grid; grid-template-rows: 64px 1fr; min-width: 0; }
.topbar {
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 1rem; border-bottom: 1px solid var(--border);
}
.btn {
  border: 1px solid var(--text);
  background: transparent; padding: .4rem .8rem;
  border-radius: 8px; cursor: pointer;
}
.content { padding: 1rem; overflow: auto; }

/* ===== MARKET MAP STYLES ===== */
.container{
  padding:20px;
}

h1{
  color:var(--blue);
  margin-bottom:10px;
}

/* Search */
.search-box{
  margin-bottom:15px;
}
.search-box input{
  padding:8px 12px;
  border:1px solid var(--border);
  border-radius:6px;
  width:240px;
}

/* Market Map Wrapper */
.market-map{
  border:2px solid var(--blue);
  border-radius:12px;
  padding:15px;
  background:#fff;
  box-shadow:var(--shadow);
  overflow:auto;
  min-width:900px;
}

/* Roads & Labels */
.road{
  text-align:center;
  font-size:13px;
  font-weight:bold;
  color:#666;
  margin:8px 0;
}

.entrance{
  text-align:center;
  font-weight:bold;
  color:red;
  margin-top:10px;
}

/* Sections Layout */
.section-row{
  display:flex;
  gap:20px;
  margin-bottom:15px;
}

.section{
  border:1px dashed #ccc;
  padding:8px;
  border-radius:8px;
  background:#fafafa;
}

.section-title{
  font-size:13px;
  font-weight:bold;
  margin-bottom:6px;
}

/* Stall Grid */
.stall-grid{
  display:grid;
  grid-template-columns:repeat(10, 32px);
  gap:4px;
}

/* Stall Style */
.stall{
  width:32px;
  height:32px;
  border:1px solid #999;
  border-radius:4px;
  font-size:10px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:.15s;
}

/* Section Colors */
.fish{ background:#d0e7ff; }
.meat{ background:#ffd6d6; }
.grocery{ background:#d4edda; }
.drygoods{ background:#fff3cd; }
.textile{ background:#e2d9ff; }
.carinderia{ background:#ffe0f0; }

/* Occupancy */
.occupied{ border:2px solid var(--blue); }
.vacant{ opacity:.6; }
.violation{ background:red; color:#fff; }
.reserved{ background:yellow; color:#111; }

/* Hover & Active */
.stall:hover{
  transform:scale(1.1);
  border-color:var(--blue);
}
.stall.active{
  background:var(--blue) !important;
  color:#fff;
}

/* Info Panel */
.info-panel{
  margin-top:15px;
  padding:12px;
  border:1px solid var(--border);
  border-radius:10px;
  background:#f4f6f8;
  font-size:14px;
}

/* Legend */
.legend{
  margin-top:12px;
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  font-size:12px;
}
.legend span{
  display:flex;
  align-items:center;
  gap:6px;
}
.legend-box{
  width:14px;
  height:14px;
  border-radius:3px;
  border:1px solid #999;
}
</style>
</head>
<body>
<div class="app">
  <aside class="sidebar">
    <div class="brand">LGU 3 ADMIN SYSTEM</div>
    <nav>
      <a href="admindashboard.html" class="nav-item active">Dashboard</a>
      <a href="adminvendor.html" class="nav-item">Vendor Management</a>
      <a href="admincommodity.html" class="nav-item">Commodity & Price Monitoring</a>
      <a href="admininspection.html" class="nav-item">Inspection & Compliance</a>
      <a href="reports.html" class="nav-item">Reports & AI Analytics</a>
      <a href="adminsettings.html" class="nav-item">Settings</a>
      <a href="main.html" class="nav-item" style="margin-top:2rem;font-weight:bold;">Logout</a>
    </nav>
  </aside>

  <section class="main">
    <header class="topbar">
      <button class="btn" id="backBtn">‚Üê Back</button>
      <button class="btn">Export</button>
    </header>
    <div class="content">

      <div class="container">
        <h1>Barangay Public Market Map</h1>

        <div class="search-box">
        üîç Search Stall No: 
        <input type="text" id="searchStall" placeholder="e.g. 32">
        </div>

        <div class="market-map">
          <div class="road">SERVICE ROAD (North)</div>

          <!-- TOP ROW: FISH + MEAT -->
          <div class="section-row">
            <div class="section">
              <div class="section-title">FISH SECTION</div>
              <div class="stall-grid" id="fishSection"></div>
            </div>
            <div class="section">
              <div class="section-title">MEAT SECTION</div>
              <div class="stall-grid" id="meatSection"></div>
            </div>
          </div>

          <div class="road">PASSAGEWAY</div>

          <!-- MIDDLE ROW: DRY GOODS + GROCERY -->
          <div class="section-row">
            <div class="section">
              <div class="section-title">DRY GOODS SECTION</div>
              <div class="stall-grid" id="drygoodsSection"></div>
            </div>
            <div class="section">
              <div class="section-title">GROCERY SECTION</div>
              <div class="stall-grid" id="grocerySection"></div>
            </div>
          </div>

          <div class="road">PASSAGEWAY</div>

          <!-- BOTTOM ROW: TEXTILE + CARINDERIA -->
          <div class="section-row">
            <div class="section">
              <div class="section-title">TEXTILE SECTION</div>
              <div class="stall-grid" id="textileSection"></div>
            </div>
            <div class="section">
              <div class="section-title">CARINDERIA</div>
              <div class="stall-grid" id="carinderiaSection"></div>
            </div>
          </div>

          <div class="entrance">‚¨á CENTER ENTRANCE (K-5th STREET)</div>
        </div>

        <div class="info-panel" id="stallInfo">
        Click a stall to view vendor information.
        </div>

        <div class="legend">
          <span><div class="legend-box fish"></div> Fish</span>
          <span><div class="legend-box meat"></div> Meat</span>
          <span><div class="legend-box grocery"></div> Grocery</span>
          <span><div class="legend-box drygoods"></div> Dry Goods</span>
          <span><div class="legend-box textile"></div> Textile</span>
          <span><div class="legend-box carinderia"></div> Carinderia</span>
          <span><div class="legend-box" style="border:2px solid #0a53c1;"></div> Occupied</span>
          <span><div class="legend-box" style="opacity:.6;"></div> Vacant</span>
          <span><div class="legend-box" style="background:red;color:white;"></div> Violation</span>
          <span><div class="legend-box" style="background:yellow;color:#111;"></div> Reserved</span>
        </div>

      </div>

    </div>
  </section>
</div>

<script>
/* ===== LOCAL STORAGE DATA ===== */
const KEY = "barangay_market_vendors";

if(!localStorage.getItem(KEY)){
  localStorage.setItem(KEY, JSON.stringify({
    32:{name:"Lily's Textile Stall", section:"Textile", status:"Occupied"},
    5:{name:"Pedro Fish Vendor", section:"Fish", status:"Occupied"},
    18:{name:"Maria Meat Shop", section:"Meat", status:"Occupied"},
    60:{name:"ABC Grocery", section:"Grocery", status:"Occupied"},
    77:{name:"Dry Goods Store", section:"Dry Goods", status:"Occupied"},
    90:{name:"Reserved Stall", section:"Textile", status:"Reserved"},
    15:{name:"Violation Stall", section:"Fish", status:"Violation"}
  }));
}

const vendors = JSON.parse(localStorage.getItem(KEY));

/* ===== CREATE STALLS FUNCTION ===== */
function createStalls(containerId, start, end, className){
  const container = document.getElementById(containerId);
  for(let i=start; i<=end; i++){
    const div = document.createElement("div");
    div.className = `stall ${className}`;
    div.dataset.no = i;
    div.innerText = i;

    if(vendors[i]){
      div.classList.add(vendors[i].status.toLowerCase());
    }else{
      div.classList.add("vacant");
    }

    container.appendChild(div);
  }
}

/* Generate Stalls */
createStalls("fishSection", 1, 20, "fish");
createStalls("meatSection", 21, 40, "meat");
createStalls("drygoodsSection", 41, 60, "drygoods");
createStalls("grocerySection", 61, 80, "grocery");
createStalls("textileSection", 81, 110, "textile");
createStalls("carinderiaSection", 111, 130, "carinderia");

/* ===== CLICK STALL ===== */
document.querySelectorAll(".stall").forEach(stall=>{
  stall.addEventListener("click", ()=>{
    document.querySelectorAll(".stall").forEach(s=>s.classList.remove("active"));
    stall.classList.add("active");

    const no = stall.dataset.no;
    const vendor = vendors[no];

    document.getElementById("stallInfo").innerHTML = vendor ? `
      <strong>${vendor.name}</strong><br>
      Stall No: ${no}<br>
      Section: ${vendor.section}<br>
      Status: ${vendor.status}
    ` : `
      <strong>Vacant Stall</strong><br>
      Stall No: ${no}<br>
      Status: Vacant
    `;
  });

  /* Double-click to assign/edit vendor (Admin) */
  stall.addEventListener("dblclick", ()=>{
    const no = stall.dataset.no;
    const name = prompt("Enter vendor name:", vendors[no]?.name || "");
    const status = prompt("Enter status (Occupied, Vacant, Violation, Reserved):", vendors[no]?.status || "Vacant");
    if(name){
      vendors[no] = { name, section: stall.classList[1], status };
      localStorage.setItem(KEY, JSON.stringify(vendors));
      stall.classList.remove("vacant","occupied","violation","reserved");
      stall.classList.add(status.toLowerCase());
      alert("Vendor updated!");
    }
  });
});

/* ===== SEARCH STALL ===== */
document.getElementById("searchStall").addEventListener("input", function(){
  const value = this.value.trim();
  document.querySelectorAll(".stall").forEach(s=>{
    s.style.outline="none";
    if(value && s.dataset.no === value){
      s.scrollIntoView({behavior:"smooth", block:"center"});
      s.style.outline="3px solid red";
    }
  });
});
</script>

</body>
</html>

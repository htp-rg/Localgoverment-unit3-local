<div class="content">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
    <h2 style="margin: 0;">Market Layout Blueprint</h2>
    <div>
      üîç <input type="text" id="stallSearch" placeholder="Search Stall No. (e.g., 32)" style="padding: 0.5rem; border-radius: 8px; border: 1px solid var(--border);">
    </div>
  </div>

  <div class="market-map-container" style="background: #fff; padding: 2rem; border-radius: 12px; border: 1px solid var(--border); box-shadow: var(--shadow); overflow: auto;">
    <div class="blueprint-grid">
      
      <div class="walkway road-top">SERVICE ROAD (6.00 METERS WIDE)</div>

      <div class="section-cluster fish-meat">
        <div class="market-section fish-section">
          <div class="section-label">FISH SECTION</div>
          <div class="stall-grid" id="grid-fish"></div>
        </div>
        <div class="market-section meat-section">
          <div class="section-label">MEAT SECTION</div>
          <div class="stall-grid" id="grid-meat"></div>
        </div>
      </div>

      <div class="section-cluster grocery-carinderia">
        <div class="market-section carinderia-section">
          <div class="section-label">CARINDERIA</div>
          <div class="stall-grid" id="grid-carinderia"></div>
        </div>
        <div class="market-section grocery-section">
          <div class="section-label">GROCERY SECTION</div>
          <div class="stall-grid" id="grid-grocery"></div>
        </div>
      </div>

      <div class="walkway horizontal-spine">PASSAGEWAY</div>

      <div class="section-cluster bottom-row">
        <div class="market-section drygoods-section">
          <div class="section-label">DRYGOODS SECTION</div>
          <div class="stall-grid" id="grid-drygoods"></div>
        </div>
        <div class="market-section textile-section">
          <div class="section-label">TEXTILE SECTION (INSIDE)</div>
          <div class="stall-grid" id="grid-textile"></div>
        </div>
      </div>

      <div class="entrance-area">
        <div class="walkway road-bottom">K-5TH STREET (11.50 METERS WIDE)</div>
        <div class="center-gate">CENTER ENTRANCE</div>
      </div>
    </div>
  </div>

  <div id="stallInfoPanel" class="card" style="margin-top: 1rem; display: none; border-left: 5px solid var(--blue);">
    <h3 id="infoStallNum" style="margin-top: 0;">Stall #--</h3>
    <div class="grid">
      <p><strong>Vendor:</strong> <span id="infoVendor">--</span></p>
      <p><strong>Status:</strong> <span id="infoStatus">--</span></p>
      <p><strong>Section:</strong> <span id="infoSection">--</span></p>
    </div>
  </div>
</div>

<style>
/* Blueprint Styling */
.blueprint-grid {
  display: flex;
  flex-direction: column;
  gap: 10px;
  min-width: 900px;
  background: #fdfdfd;
  padding: 10px;
}

.section-cluster { display: flex; gap: 20px; }
.market-section { border: 2px solid #555; padding: 10px; flex: 1; background: #f8f9fa; }
.section-label { font-weight: bold; font-size: 0.8rem; text-align: center; border-bottom: 1px solid #555; margin-bottom: 8px; padding-bottom: 4px; }

.stall-grid { display: grid; grid-template-columns: repeat(10, 1fr); gap: 2px; }
.stall {
  aspect-ratio: 1; border: 1px solid #999; display: flex; align-items: center; 
  justify-content: center; font-size: 0.6rem; cursor: pointer; transition: 0.2s;
}
.stall:hover { background: #ffeeba; transform: scale(1.1); z-index: 5; }
.stall.occupied { background: #d1d3e2; }
.stall.selected { background: #ffc107 !important; border-color: #000; font-weight: bold; }
.stall.highlight { background: #28a745; color: white; border-color: #1e7e34; }

.walkway { background: #eee; border: 1px dashed #999; text-align: center; font-size: 0.7rem; color: #666; padding: 5px; }
.center-gate { 
  border: 2px solid red; color: red; width: 150px; margin: 0 auto; 
  text-align: center; font-weight: bold; padding: 5px; margin-top: -10px; background: white;
}
</style>

<script>
// Mock Stall Data based on image legend
const stallData = {
  32: { vendor: "Lily's Textile Stall", status: "Occupied", section: "Textile" },
  15: { vendor: "Unassigned", status: "Available", section: "Dry Goods" }
};

function initMap() {
  const sections = [
    { id: 'grid-fish', count: 41, start: 1, section: 'Fish' },
    { id: 'grid-meat', count: 90, start: 42, section: 'Meat' },
    { id: 'grid-grocery', count: 88, start: 133, section: 'Grocery' },
    { id: 'grid-drygoods', count: 92, start: 221, section: 'Dry Goods' },
    { id: 'grid-textile', count: 63, start: 313, section: 'Textile' }
  ];

  sections.forEach(sec => {
    const grid = document.getElementById(sec.id);
    for (let i = 0; i < sec.count; i++) {
      const stallNum = sec.start + i;
      const div = document.createElement('div');
      div.className = 'stall' + (stallData[stallNum] ? ' occupied' : '');
      div.innerText = stallNum;
      div.onclick = () => showStallInfo(stallNum, sec.section);
      grid.appendChild(div);
    }
  });
}

function showStallInfo(num, section) {
  const panel = document.getElementById('stallInfoPanel');
  const data = stallData[num] || { vendor: 'None', status: 'Vacant' };
  
  document.querySelectorAll('.stall').forEach(s => s.classList.remove('selected'));
  const target = Array.from(document.querySelectorAll('.stall')).find(s => s.innerText == num);
  if(target) target.classList.add('selected');

  panel.style.display = 'block';
  document.getElementById('infoStallNum').innerText = 'Stall #' + num;
  document.getElementById('infoVendor').innerText = data.vendor;
  document.getElementById('infoStatus').innerText = data.status;
  document.getElementById('infoSection').innerText = section;
}

// Search Functionality
document.getElementById('stallSearch').addEventListener('input', function(e) {
  const num = e.target.value;
  document.querySelectorAll('.stall').forEach(s => {
    s.classList.remove('highlight');
    if(num && s.innerText == num) {
      s.classList.add('highlight');
      s.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
  });
});

initMap();
</script>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Barangay Market Map - LGU Admin</title>

<style>
:root {
  --text:#111;
  --blue:#4e73df;
  --border:#e6e8eb;
  --shadow:0 6px 24px rgba(0,0,0,.06);
}

*{box-sizing:border-box;}
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f4f6f9;
  overflow:hidden;
}

.app{
  display:grid;
  grid-template-columns:240px 1fr;
  height:100vh;
}

/* SIDEBAR */
.sidebar{
  background:var(--blue);
  color:#fff;
}
.brand{
  font-weight:bold;
  padding:1rem;
  border-bottom:1px solid rgba(255,255,255,.2);
}
nav{padding:1rem;}
.nav-item{
  display:block;
  padding:.6rem;
  border-radius:8px;
  text-decoration:none;
  color:#fff;
  margin-bottom:6px;
}
.nav-item:hover{background:rgba(255,255,255,.15);}

/* MAIN */
.main{
  display:grid;
  grid-template-rows:60px 1fr;
  background:#eaecf4;
}
.topbar{
  background:#fff;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 1rem;
  border-bottom:1px solid var(--border);
}
.content{
  padding:1rem;
  display:flex;
  flex-direction:column;
}

/* MAP */
.map-wrapper{
  border:1px solid #ccc;
  background:#f8f9fc;
  width:100%;
  height:70vh;
  border-radius:12px;
  overflow:hidden;
}
#map{transform-origin:0 0;cursor:grab;}

/* STALL */
.stall{stroke:#444;stroke-width:.5;cursor:pointer;}
.stall:hover{stroke-width:2;stroke:#000;}
.occupied{fill:#9ec5ff;}
.vacant{fill:#fff;}
.violation{fill:#ff4d4d;}
.reserved{fill:#ffd700;}
.walkway{fill:#d1d3e2;opacity:.9;}
.label{font-size:16px;font-weight:bold;fill:var(--blue);}
.facility{font-size:11px;font-weight:bold;fill:#333;}

/* INFO */
.info-panel{
  margin-top:10px;
  background:#fff;
  padding:10px;
  border-radius:8px;
  border-left:5px solid var(--blue);
  box-shadow:var(--shadow);
  font-size:14px;
}
.legend{
  display:flex;
  gap:15px;
  margin-top:8px;
  font-size:12px;
}
.box{width:12px;height:12px;border:1px solid #333;}
.legend-item{display:flex;align-items:center;gap:5px;}
</style>
</head>
<body>

<div class="app">

<!-- SIDEBAR -->
<aside class="sidebar">
  <div class="brand">LGU 3 ADMIN SYSTEM</div>
  <nav>
    <a href="#" class="nav-item">Market Map</a>
    <a href="#" class="nav-item">Dashboard</a>
    <a href="#" class="nav-item">Vendor Management</a>
    <a href="#" class="nav-item">Inspection</a>
    <a href="#" class="nav-item">Reports</a>
    <a href="#" class="nav-item">Settings</a>
  </nav>
</aside>

<!-- MAIN -->
<section class="main">
  <div class="topbar">
    <h3>Barangay Market Layout Manager</h3>
    <input id="search" placeholder="Search stall no..." style="padding:6px;border-radius:6px;border:1px solid #ccc;">
  </div>

  <div class="content">

    <div class="map-wrapper">
      <svg id="map" width="1400" height="900">

        <!-- MARKET BORDER -->
        <polygon points="50,50 1200,50 1300,200 1250,850 100,850 50,450"
          fill="#fff" stroke="#b7b9cc" stroke-width="2"/>

        <!-- SECTION LABELS -->
        <text x="220" y="90" class="label">WET SECTION</text>
        <text x="760" y="90" class="label">DRY SECTION</text>

        <!-- WALKWAYS (FIXED, NO OVERLAP) -->
        <!-- MAIN CENTER AISLE -->
        <rect x="520" y="120" width="80" height="650" class="walkway"/>

        <!-- WET SECTION AISLES -->
        <rect x="120" y="310" width="360" height="50" class="walkway"/>
        <rect x="120" y="520" width="360" height="50" class="walkway"/>

        <!-- DRY SECTION AISLES -->
        <rect x="620" y="310" width="520" height="50" class="walkway"/>
        <rect x="620" y="520" width="520" height="50" class="walkway"/>

        <!-- FACILITIES (NO OVERLAP) -->
        <!-- ADMIN OFFICE -->
        <rect x="80" y="120" width="140" height="60" fill="#e3f2fd" stroke="#4e73df"/>
        <text x="95" y="155" class="facility">ADMIN OFFICE</text>

        <!-- CR MALE -->
        <rect x="80" y="700" width="100" height="50" fill="#e8f5e9" stroke="#2e7d32"/>
        <text x="95" y="730" class="facility">CR MALE</text>

        <!-- CR FEMALE -->
        <rect x="190" y="700" width="110" height="50" fill="#fce4ec" stroke="#c2185b"/>
        <text x="200" y="730" class="facility">CR FEMALE</text>

        <!-- ENTRANCE -->
        <rect x="560" y="70" width="140" height="35" fill="#fff3cd" stroke="#f0ad4e"/>
        <text x="590" y="92" class="facility">ENTRANCE</text>

        <!-- EXIT -->
        <rect x="980" y="800" width="140" height="35" fill="#fff3cd" stroke="#f0ad4e"/>
        <text x="1020" y="822" class="facility">EXIT</text>

        <!-- EMERGENCY EXIT -->
        <rect x="1180" y="420" width="140" height="35" fill="#ffebee" stroke="#c62828"/>
        <text x="1190" y="442" class="facility">EMERGENCY EXIT</text>

        <!-- STALL GROUPS -->
        <g id="wetStalls"></g>
        <g id="dryStalls"></g>

      </svg>
    </div>

    <div class="info-panel" id="info">
      Click a stall to view vendor info.
    </div>

    <div class="legend">
      <div class="legend-item"><div class="box vacant"></div>Vacant</div>
      <div class="legend-item"><div class="box occupied"></div>Occupied</div>
      <div class="legend-item"><div class="box reserved"></div>Reserved</div>
      <div class="legend-item"><div class="box violation"></div>Violation</div>
    </div>

  </div>
</section>
</div>

<script>
const vendors = {
  2:{name:"Pedro Fish Vendor",status:"occupied"},
  10:{name:"Maria Meat Shop",status:"occupied"},
  20:{name:"Juan Cold Storage",status:"violation"},
  105:{name:"Elena Boutique",status:"reserved"},
};

const STALL_SIZE = 38;
const GAP = 6;

function drawBlock(start,x,y,rows,cols,section){
  const g=document.getElementById(section==="wet"?"wetStalls":"dryStalls");
  let num=start;

  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      let sx=x+c*(STALL_SIZE+GAP);
      let sy=y+r*(STALL_SIZE+GAP);

      const rect=document.createElementNS("http://www.w3.org/2000/svg","rect");
      rect.setAttribute("x",sx);
      rect.setAttribute("y",sy);
      rect.setAttribute("width",STALL_SIZE);
      rect.setAttribute("height",STALL_SIZE);
      rect.classList.add("stall");

      let status=vendors[num]?vendors[num].status:"vacant";
      rect.classList.add(status);
      rect.dataset.no=num;

      rect.onclick=()=>{
        const v=vendors[num];
        document.getElementById("info").innerHTML=v?
          `<b>Stall ${num}</b> | ${v.name} | <b>${v.status.toUpperCase()}</b>`:
          `<b>Stall ${num}</b> | VACANT`;
      };

      g.appendChild(rect);

      const text=document.createElementNS("http://www.w3.org/2000/svg","text");
      text.setAttribute("x",sx+6);
      text.setAttribute("y",sy+24);
      text.setAttribute("font-size","10");
      text.textContent=num;
      text.style.pointerEvents="none";
      g.appendChild(text);

      num++;
    }
  }
}

/* WET SECTION STALLS */
drawBlock(1,140,170,4,5,"wet"); 
drawBlock(21,140,390,4,5,"wet");
drawBlock(41,140,610,4,5,"wet");

/* DRY SECTION STALLS */
drawBlock(100,650,170,4,7,"dry");
drawBlock(130,650,390,4,7,"dry");
drawBlock(160,650,610,4,7,"dry");

/* SEARCH */
document.getElementById("search").oninput=function(){
  const val=this.value;
  document.querySelectorAll(".stall").forEach(s=>{
    if(s.dataset.no===val && val!==""){
      s.style.stroke="#000";
      s.style.strokeWidth="3";
    }else{
      s.style.stroke="#444";
      s.style.strokeWidth=".5";
    }
  });
};

/* PAN & ZOOM */
let scale=1,drag=false,startX,startY,offsetX=0,offsetY=0;
const map=document.getElementById("map");

map.addEventListener("wheel",e=>{
  e.preventDefault();
  scale+=e.deltaY*-0.001;
  scale=Math.min(Math.max(0.4,scale),3);
  map.style.transform=`translate(${offsetX}px,${offsetY}px) scale(${scale})`;
});

map.addEventListener("mousedown",e=>{
  if(e.target.classList.contains("stall"))return;
  drag=true;
  startX=e.clientX-offsetX;
  startY=e.clientY-offsetY;
  map.style.cursor="grabbing";
});

window.addEventListener("mouseup",()=>{drag=false;map.style.cursor="grab";});
window.addEventListener("mousemove",e=>{
  if(!drag)return;
  offsetX=e.clientX-startX;
  offsetY=e.clientY-startY;
  map.style.transform=`translate(${offsetX}px,${offsetY}px) scale(${scale})`;
});
</script>

</body>
</html>

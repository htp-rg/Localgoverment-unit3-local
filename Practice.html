<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Barangay Market Map - LGU Admin</title>
<style>
:root {
  --text: #111111;
  --blue: #0a53c1;
  --ink-20: #f4f6f8;
  --white: #ffffff;
  --border: #e6e8eb;
  --shadow: 0 6px 24px rgba(0, 0, 0, .06);
  --fish: #9ec5ff;
  --meat: #ff9e9e;
  --grocery: #ffe699;
  --drygoods: #c2f0c2;
  --textile: #d1c2f0;
  --carinderia: #f0b7c2;
}
* { box-sizing: border-box; }
body { margin:0;font-family:Inter, sans-serif;background:var(--white);color:var(--text);}
.app { display:grid; grid-template-columns:240px 1fr; min-height:100vh;}
.sidebar { border-right:1px solid var(--border); background:#4e73df; color:#fff; }
.brand { font-weight:800; text-transform:uppercase; padding:1rem; border-bottom:1px solid rgba(255,255,255,.2);}
nav { padding:1rem;}
.nav-item { display:block; padding:.6rem; border-radius:8px; text-decoration:none; color:#fff; }
.nav-item:hover, .nav-item.active { background: rgba(255,255,255,.15);}
.main { display:grid; grid-template-rows:64px 1fr; min-width:0; }
.topbar { display:flex; align-items:center; justify-content:space-between; padding:0 1rem; border-bottom:1px solid var(--border);}
.btn { border:1px solid var(--text); background:transparent; padding:.4rem .8rem; border-radius:8px; cursor:pointer;}
.content { padding:1rem; overflow:auto;}
.map-wrapper { border:1px solid #ccc; background:#f8f9fc; width:100%; height:70vh; border-radius:12px; overflow:hidden; position:relative;}
svg { user-select:none; }
#map-group { cursor:grab; }
.stall{stroke:#444;stroke-width:.5;cursor:pointer;}
.stall:hover{stroke-width:2;stroke:#000;}
.occupied{opacity:1;}
.vacant{opacity:.6;}
.violation{fill:red;}
.reserved{fill:yellow;}
.walkway{fill:#d1d3e2; opacity:.6;}
.label{font-size:18px;font-weight:bold;fill:var(--blue); pointer-events:none;}
.facility-text{font-size:11px;font-weight:bold;fill:#333; pointer-events:none;}
.info-panel{ margin-top:10px; background:#fff; padding:15px; border-radius:8px; border-left:5px solid var(--blue); box-shadow:0 6px 24px rgba(0, 0, 0, .06); font-size:14px; }
.legend{ margin-top:12px; display:flex; flex-wrap:wrap; gap:12px; font-size:12px;}
.legend span{ display:flex; align-items:center; gap:6px;}
.legend-box{ width:14px; height:14px; border-radius:3px; border:1px solid #999;}
</style>
</head>
<body>
<div class="app">
  <aside class="sidebar">
    <div class="brand">LGU 3 ADMIN SYSTEM</div>
    <nav>
      <a href="admindashboard.html" class="nav-item active">Dashboard</a>
      <a href="adminvendor.html" class="nav-item">Vendor Management</a>
      <a href="admincommodity.html" class="nav-item">Commodity and Price Monitoring</a>
      <a href="admininspection.html" class="nav-item">Inspection and Compliance</a>
      <a href="reports.html" class="nav-item">Reports and Dashboard with AI Analytic</a>
      <a href="adminsettings.html" class="nav-item">Settings</a>
      <a href="main.html" class="nav-item" style="margin-top:2rem;font-weight:bold;">Logout</a>
    </nav>
  </aside>

  <section class="main">
    <header class="topbar">
      <button class="btn" id="backBtn">‚Üê Back</button>
      <button class="btn">Export</button>
    </header>

    <div class="content">
      <div class="map-wrapper" id="wrapper">
        <svg width="1300" height="900" viewBox="0 0 1300 900">
          <g id="map-group">
            <rect x="20" y="20" width="1260" height="860" fill="none" stroke="#b7b9cc" stroke-width="2" rx="10"/>
            <rect x="600" y="20" width="80" height="860" class="walkway"/>
            <rect x="20" y="270" width="560" height="50" class="walkway"/>
            <rect x="700" y="270" width="580" height="50" class="walkway"/>
            <rect x="20" y="570" width="560" height="50" class="walkway"/>
            <rect x="700" y="570" width="580" height="50" class="walkway"/>
            <text x="200" y="60" class="label">WET SECTION</text>
            <text x="880" y="60" class="label">DRY SECTION</text>
            <g id="wetStalls"></g>
            <g id="dryStalls"></g>
          </g>
        </svg>
      </div>

      <div class="info-panel" id="info">Click a stall to view vendor info.</div>
      <div class="legend">
        <span><div class="legend-box" style="background:var(--fish)"></div> Fish</span>
        <span><div class="legend-box" style="background:var(--meat)"></div> Meat</span>
        <span><div class="legend-box" style="background:var(--grocery)"></div> Grocery</span>
        <span><div class="legend-box" style="background:var(--drygoods)"></div> Dry Goods</span>
        <span><div class="legend-box" style="background:var(--textile)"></div> Textile</span>
        <span><div class="legend-box" style="background:var(--carinderia)"></div> Carinderia</span>
      </div>
    </div>
  </section>
</div>

<script>
// Stalls configuration
const vendors = {
  2:{name:"Pedro Fish Vendor",category:"fish",status:"occupied"},
  3:{name:"Luis Fish Vendor",category:"fish",status:"occupied"},
  10:{name:"Maria Meat Shop",category:"meat",status:"occupied"},
  15:{name:"Carlo Grocery",category:"grocery",status:"occupied"},
  20:{name:"Juan Cold Storage",category:"drygoods",status:"violation"},
  105:{name:"Elena Boutique",category:"textile",status:"reserved"}
};

const STALL_SIZE = 40, GAP = 8;
const categoryColor = {
  fish:"var(--fish)",
  meat:"var(--meat)",
  grocery:"var(--grocery)",
  drygoods:"var(--drygoods)",
  textile:"var(--textile)",
  carinderia:"var(--carinderia)"
};

// Sections
const sections = [
  {section:"wet", category:"fish", label:"Fish", numbers:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]},
  {section:"wet", category:"meat", label:"Meat", numbers:[21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]},
  {section:"wet", category:"grocery", label:"Grocery", numbers:[41,42,43,44,45,46,47,48,49,50,51,52,53,54,55]},
  {section:"dry", category:"drygoods", label:"Dry Goods", numbers:[56,57,58,59,60,61,62,63,64,65,66,67,68,69,70]},
  {section:"dry", category:"textile", label:"Textile", numbers:[71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100]},
  {section:"dry", category:"carinderia", label:"Carinderia", numbers:[101,102,103,104,105,106,107,108,109,110]}
];

// Draw stalls neatly aligned to walkways
function drawSection(sectionData, startX, startY){
  const g = document.getElementById(sectionData.section==="wet"?"wetStalls":"dryStalls");
  const cols = 6;
  let x = startX;
  let y = startY;

  sectionData.numbers.forEach((num, idx) => {
    const col = idx % cols;
    const row = Math.floor(idx / cols);
    const sx = x + col * (STALL_SIZE + GAP);
    const sy = y + row * (STALL_SIZE + GAP);

    // Stall rectangle
    const rect = document.createElementNS("http://www.w3.org/2000/svg","rect");
    rect.setAttribute("x", sx);
    rect.setAttribute("y", sy);
    rect.setAttribute("width", STALL_SIZE);
    rect.setAttribute("height", STALL_SIZE);
    rect.setAttribute("rx", "4");
    rect.classList.add("stall");
    const v = vendors[num];
    rect.setAttribute("fill", v ? categoryColor[v.category] : categoryColor[sectionData.category]);
    rect.classList.add(v ? v.status : "vacant");
    rect.dataset.no = num;
    rect.onclick = () => {
      document.getElementById("info").innerHTML = v ?
        `<b>Stall ${num}</b> | Vendor: ${v.name} | Category: ${v.category.toUpperCase()} | Status: <b>${v.status.toUpperCase()}</b>` :
        `<b>Stall ${num}</b> | Category: ${sectionData.category.toUpperCase()} | Status: <b>VACANT</b>`;
    };
    g.appendChild(rect);

    // Stall number text
    const text = document.createElementNS("http://www.w3.org/2000/svg","text");
    text.setAttribute("x", sx + 8);
    text.setAttribute("y", sy + 25);
    text.setAttribute("font-size", "11");
    text.setAttribute("font-weight", "bold");
    text.style.pointerEvents = "none";
    text.textContent = num;
    g.appendChild(text);
  });

  // Return new Y for next section
  return startY + Math.ceil(sectionData.numbers.length / cols) * (STALL_SIZE + GAP) + 20;
}

// Draw all sections
let wetStartY = 90;
let dryStartY = 90;
sections.forEach(s => {
  if(s.section === "wet"){
    wetStartY = drawSection(s, 250, wetStartY); // aligned under wet section walkway
  } else {
    dryStartY = drawSection(s, 720, dryStartY); // aligned under dry section walkway
  }
});

// Pan & Zoom
const wrapper=document.getElementById("wrapper"), mapGroup=document.getElementById("map-group");
let scale=1, panX=20, panY=20, isPanning=false, startX, startY;
function updateTransform(){ mapGroup.setAttribute("transform", `translate(${panX}, ${panY}) scale(${scale})`);}
wrapper.addEventListener("wheel",e=>{
  e.preventDefault();
  const zoomFactor=.1, dir=e.deltaY>0?-1:1, newScale=Math.min(Math.max(.4,scale+dir*zoomFactor),2.5);
  const rect=wrapper.getBoundingClientRect(), mouseX=e.clientX-rect.left, mouseY=e.clientY-rect.top;
  const dx=(mouseX-panX)/scale, dy=(mouseY-panY)/scale;
  panX=mouseX-dx*newScale; panY=mouseY-dy*newScale; scale=newScale; updateTransform();
},{passive:false});
wrapper.addEventListener("mousedown",e=>{if(e.target.classList.contains("stall"))return;isPanning=true;startX=e.clientX-panX;startY=e.clientY-panY; wrapper.style.cursor="grabbing";});
window.addEventListener("mouseup",()=>{isPanning=false; wrapper.style.cursor="default";});
window.addEventListener("mousemove",e=>{if(!isPanning)return; panX=e.clientX-startX; panY=e.clientY-startY; updateTransform();});
updateTransform();
</script>
</body>
</html>

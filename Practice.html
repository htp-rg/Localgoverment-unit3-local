<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Barangay Market Map</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f4f6f9;
}
.app{
  display:grid;
  grid-template-columns:220px 1fr;
  height:100vh;
}
.sidebar{
  background:#4e73df;
  color:#fff;
  padding:15px;
}
.sidebar h2{
  font-size:16px;
  margin-bottom:20px;
}
.sidebar a{
  display:block;
  padding:8px;
  color:#fff;
  text-decoration:none;
  border-radius:6px;
  margin-bottom:5px;
}
.sidebar a:hover{background:#fff;color:#4e73df;}

.main{
  display:flex;
  flex-direction:column;
}
.topbar{
  background:#fff;
  padding:10px 15px;
  border-bottom:1px solid #ddd;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.content{
  padding:15px;
  overflow:hidden;
}

/* MAP CONTAINER */
.map-wrapper{
  border:2px solid #333;
  background:#ddd;
  width:100%;
  height:600px;
  position:relative;
  overflow:hidden;
  border-radius:10px;
}

/* zoom + drag */
#map{
  transform-origin:0 0;
  cursor:grab;
}

/* STALL STYLE */
.stall{
  fill:#fff;
  stroke:#555;
  stroke-width:1;
  cursor:pointer;
}
.stall:hover{stroke:#000;stroke-width:2;}
.occupied{fill:#9ec5ff;}
.vacant{fill:#eaeaea;}
.violation{fill:#ff4d4d;}
.reserved{fill:#ffd700;}

/* SECTION COLORS */
.wet { fill:#d0e7ff; }
.dry { fill:#fff3cd; }

/* WALKWAYS */
.walkway{
  fill:#666;
  opacity:.6;
}

/* LABELS */
.label{
  font-size:14px;
  font-weight:bold;
  fill:#000;
}

/* INFO PANEL */
.info-panel{
  margin-top:10px;
  background:#fff;
  padding:10px;
  border-radius:6px;
  border:1px solid #ddd;
  font-size:14px;
}
</style>
</head>
<body>

<div class="app">
  <div class="sidebar">
    <h2>LGU ADMIN</h2>
    <a href="#">Dashboard</a>
    <a href="#">Vendor Management</a>
    <a href="#">Compliance</a>
    <a href="#">Logout</a>
  </div>

  <div class="main">
    <div class="topbar">
      <h3>Barangay Market Map</h3>
      <input id="search" placeholder="Search stall no..." style="padding:5px;">
    </div>

    <div class="content">
      <div class="map-wrapper">
        <svg id="map" width="1400" height="800">

          <!-- MARKET BORDER -->
          <polygon points="50,50 1200,50 1350,250 1250,700 100,700 50,450"
                   fill="#f7f0c8" stroke="#333" stroke-width="4"/>

          <!-- MAIN WALKWAYS -->
          <rect x="600" y="80" width="70" height="580" class="walkway"/>
          <rect x="80" y="350" width="1100" height="70" class="walkway"/>
          <rect x="900" y="200" width="70" height="400" transform="rotate(25 900 200)" class="walkway"/>

          <!-- SECTION LABELS -->
          <text x="150" y="110" class="label">FISH SECTION (WET)</text>
          <text x="150" y="310" class="label">MEAT SECTION (WET)</text>
          <text x="150" y="560" class="label">FRUIT & VEGETABLE (WET)</text>

          <text x="750" y="110" class="label">GROCERY (DRY)</text>
          <text x="750" y="310" class="label">DRY GOODS (DRY)</text>
          <text x="750" y="560" class="label">TEXTILE (DRY)</text>

          <text x="1020" y="350" class="label">CARINDERIA (WET)</text>

          <!-- STALL BLOCKS -->
          <g id="fish"></g>
          <g id="meat"></g>
          <g id="veg"></g>

          <g id="grocery"></g>
          <g id="drygoods"></g>
          <g id="textile"></g>

          <g id="carinderia" transform="rotate(25 950 420)"></g>

        </svg>
      </div>

      <div class="info-panel" id="info">Click a stall to view details.</div>
    </div>
  </div>
</div>

<script>
const vendors = {
  3:{name:"Pedro Fish Vendor",status:"occupied"},
  8:{name:"Maria Meat Shop",status:"occupied"},
  15:{name:"Violation Stall",status:"violation"},
  40:{name:"Reserved Stall",status:"reserved"},
};

/* CREATE STALL BLOCK */
function createBlock(groupId,start,x,y,rows,cols,dx,dy,sectionClass){
  const g=document.getElementById(groupId);
  let num=start;
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      const rect=document.createElementNS("http://www.w3.org/2000/svg","rect");
      rect.setAttribute("x",x+c*dx);
      rect.setAttribute("y",y+r*dy);
      rect.setAttribute("width",38);
      rect.setAttribute("height",38);
      rect.classList.add("stall",sectionClass);

      let status="vacant";
      if(vendors[num]) status=vendors[num].status;
      rect.classList.add(status);
      rect.dataset.no=num;

      rect.onclick=()=>{
        const v=vendors[num];
        document.getElementById("info").innerHTML=v?
          `<b>Stall ${num}</b><br>${v.name}<br>Status: ${v.status}`:
          `<b>Stall ${num}</b><br>Status: Vacant`;
      };

      g.appendChild(rect);

      const text=document.createElementNS("http://www.w3.org/2000/svg","text");
      text.setAttribute("x",x+c*dx+10);
      text.setAttribute("y",y+r*dy+24);
      text.setAttribute("font-size","9");
      text.textContent=num;
      g.appendChild(text);

      num++;
    }
  }
}

/* WET SECTIONS */
createBlock("fish",1,120,130,4,6,45,45,"wet");
createBlock("meat",25,120,330,4,6,45,45,"wet");
createBlock("veg",49,120,530,4,6,45,45,"wet");

/* DRY SECTIONS */
createBlock("grocery",73,720,130,4,6,45,45,"dry");
createBlock("drygoods",97,720,330,4,6,45,45,"dry");
createBlock("textile",121,720,530,4,6,45,45,"dry");

/* CARINDERIA (DIAGONAL) */
createBlock("carinderia",145,950,350,4,4,45,45,"wet");

/* SEARCH */
document.getElementById("search").oninput=function(){
  const val=this.value;
  document.querySelectorAll(".stall").forEach(s=>{
    s.style.stroke="#555";
    if(s.dataset.no===val){
      s.style.stroke="black";
      s.style.strokeWidth=3;
    }
  });
};

/* ZOOM + DRAG */
let scale=1,drag=false,startX,startY,offsetX=0,offsetY=0;
const map=document.getElementById("map");

map.addEventListener("wheel",e=>{
  e.preventDefault();
  scale+=e.deltaY*-0.001;
  scale=Math.min(Math.max(0.5,scale),2.5);
  map.style.transform=`translate(${offsetX}px,${offsetY}px) scale(${scale})`;
});

map.addEventListener("mousedown",e=>{
  drag=true;
  startX=e.clientX-offsetX;
  startY=e.clientY-offsetY;
  map.style.cursor="grabbing";
});
window.addEventListener("mouseup",()=>{drag=false;map.style.cursor="grab";});
window.addEventListener("mousemove",e=>{
  if(!drag)return;
  offsetX=e.clientX-startX;
  offsetY=e.clientY-startY;
  map.style.transform=`translate(${offsetX}px,${offsetY}px) scale(${scale})`;
});
</script>

</body>
</html>

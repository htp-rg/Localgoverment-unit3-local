<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>LGU 3 | OTP Verification</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
body{
  background:#f5f9ff;
  color:#1b2b4b;
  margin:0;
  font-family: Inter, system-ui, sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.card{
  background:#ffffff;             
  border:2px solid #1e4fd8;         
  padding:2rem;
  border-radius:14px;
  width:360px;
  box-shadow:0 8px 25px rgba(0,0,0,0.08);
}

h1{
  text-align:center;
  color:#0b2c6f;
}

input,
select,
button{
  width:85%;
  padding:.7rem;
  margin:.5rem auto;
  display:block;
  border-radius:10px;
  border:1px solid #cbd5e1;
  font-size:.95rem;

  box-sizing:border-box;
  appearance:none;
  -webkit-appearance:none;
  -moz-appearance:none;
}

input:focus, select:focus{
  outline:none;
  border-color:#1e4fd8;
}

button{
  background:#1e4fd8;
  color:#fff;
  font-weight:600;
  border:none;
  cursor:pointer;
}

button:hover{
  background:#163db3;
}

  select{
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%231e4fd8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
  background-repeat:no-repeat;
  background-position:right .8rem center;
  background-size:14px;
  padding-right:2.2rem;
}
#msg{text-align:center;color:red;font-weight:600}
</style>
</head>

<body>
<div class="card">
  <h2>OTP Verification</h2>

  <input type="text" id="otpInput" placeholder="Enter OTP">
  <button onclick="sendOTP()">Send OTP</button>
  <button onclick="verify()">Verify</button>

  <div id="msg"></div>
</div>

<script>
let otp=null;

const role=localStorage.getItem("role");
const email=localStorage.getItem("email");

const roles={
  staff:{key:"woZPn1QHpjKc4M8Qo",service:"service_dvrf2ar",template:"template_tseir4g",redirect:"barangayinspection.html"},
  market:{key:"Q3BrdJupCkfLyAxc9",service:"service_twsjr4p",template:"template_864di8m",redirect:"Marketmap.html"},
  admin:{key:"ITbHFP1WBTFPISemM",service:"service_qvm338i",template:"template_koj1ggb",redirect:"admindashboard.html"},
  user:{key:"rmTZmSimwN_68ZgFp",service:"service_da66ha6",template:"template_0mebf9d",redirect:"userdashboard.html"}
};

function sendOTP(){
  emailjs.init(roles[role].key);
  otp=Math.floor(100000+Math.random()*900000);

  emailjs.send(roles[role].service,roles[role].template,{
    to_email:email,
    passcode:otp
  });

  msg.textContent="OTP sent to email";
}

function verify(){
  if(otpInput.value==otp){
    msg.style.color="green";
    msg.textContent="Login successful";
    setTimeout(()=>window.location.href=roles[role].redirect,1000);
  }else{
    msg.style.color="red";
    msg.textContent="Invalid OTP";
  }
}
</script>
</body>
</html>
